<!-- - sunoでbgm生成 -->
<!-- - kill slideshowの強化 -->
<!-- - 監視中に挿入した時、permission errorがでる -->
<!-- - アンマウントのパス DCIMがあればアンマウント（監視と同じ方法） -->
- app.py実行した時、起動まで行う
- UIUX改善
<!-- アップロードする写真がなければ、最近の100枚を再生する（その旨表示する） -->
ログの表示フィルタリング
停止ボタンは、アップロード停止、スライドショー停止、SD監視の停止があることをステータスに応じて表示わける

# 期待する挙動
- SDカードに未アップロードの写真が存在
- アップロード済み写真logと比較して、差分をアップロードする写真を決める
- 差分をスライドショーで表示する
- スライドショーの再生と並行してアップロードする
- アップロードが完了後もスライドショーは継続
- SDカードに未アップロードの写真が存在しない場合、SDカードに存在する最新100枚の写真がスライドショーで再生される
- SDカードに一切の写真が存在しない場合、写真がない旨を伝える

# ユーザーによる GCP 操作不要化（外販化）計画
## 目的
- エンドユーザーは GCP や credentials.json を触らず、ブラウザ操作のみで Google フォト連携を完了できる
- Raspberry Pi はユーザーの Google フォトへ安全に写真をアップロードできる

## タスク一覧
1. OAuth フロー整備
   - GCP プロジェクトに Web クライアントを作成し 3-legged OAuth を採用
   - OAuth 同意画面を External で設定し Google に検証申請
   - スコープ: `openid email profile photoslibrary`（必要に応じ `photoslibrary.appendonly`）
2. ユーザー登録自動化
   - OAuth `id_token.sub` をキーに User テーブルを upsert
   - `refresh_token` を KMS 等で暗号化して保存
3. デバイス（Pi）ペアリング
   - Pi 起動時に 6 桁ペアリングコードを生成
   - ユーザーが Web でコードを入力→ `device_id` と `user_id` をひも付け
4. トークン管理 / アップロード経路
   - Google トークンはバックエンドで保持し、Pi は専用 API でアップロード依頼（推奨）
   - 401/invalid_grant 検出時に UI で再認証を促す
5. ローカルセットアップ UI
   - Pi が mDNS/QR でローカル設定ページ (HTTPS) を公開
   - スマホが同一 LAN からアクセス→Google 連携ボタン→ペアリング完了
6. セキュリティ & コンプライアンス
   - CSRF 対策、HTTPS、最小権限設計
   - 退会時: token 失効 + ユーザーデータ完全削除 (GDPR 対応)
7. スケール & 運用
   - API 使用量モニタリング／レート制限
   - サポート窓口、OTA アップデート配信計画

## マイルストーン
- [ ] M1: OAuth External 同意画面作成 & テストユーザー 5 名でβ開始
- [ ] M2: デバイスペアリング実装 & Pi↔Backend API 確立
- [ ] M3: Google 審査完了、本番公開